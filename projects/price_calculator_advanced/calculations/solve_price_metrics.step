step: solve_price_metrics
    belongs to: calculations
    expects: mode as text
    returns: results as table

    declare:
        price as number
        margin as number
        profit as number
        markup as number
        cost as number
        results as table

    do:
        if mode equals "price_margin"
            call get_number_input with "Enter Price: " storing result in price
            call get_number_input with "Enter Margin: " storing result in margin
            set profit to price * (margin / 100)
            set cost to price - profit
            set markup to (profit / cost) * 100

        otherwise if mode equals "price_profit"
            call get_number_input with "Enter Price: " storing result in price
            call get_number_input with "Enter Profit: " storing result in profit
            set cost to price - profit
            set margin to (profit / price) * 100
            set markup to (profit / cost) * 100

        otherwise if mode equals "price_markup"
            call get_number_input with "Enter Price: " storing result in price
            call get_number_input with "Enter Markup: " storing result in markup
            set cost to price / (1 + (markup / 100))
            set profit to price - cost
            set margin to (profit / price) * 100

        otherwise if mode equals "price_cost"
            call get_number_input with "Enter Price: " storing result in price
            call get_number_input with "Enter Cost: " storing result in cost
            set profit to price - cost
            set margin to (profit / price) * 100
            set markup to (profit / cost) * 100

        otherwise if mode equals "margin_profit"
            call get_number_input with "Enter Margin: " storing result in margin
            call get_number_input with "Enter Profit: " storing result in profit
            set price to profit / (margin / 100)
            set cost to price - profit
            set markup to (profit / cost) * 100

        otherwise if mode equals "margin_cost"
            call get_number_input with "Enter Margin: " storing result in margin
            call get_number_input with "Enter Cost: " storing result in cost
            set price to cost / (1 - (margin / 100))
            set profit to price - cost
            set markup to (profit / cost) * 100

        otherwise if mode equals "profit_markup"
            call get_number_input with "Enter Profit: " storing result in profit
            call get_number_input with "Enter Markup: " storing result in markup
            set cost to profit / (markup / 100)
            set price to cost + profit
            set margin to (profit / price) * 100

        otherwise if mode equals "profit_cost"
            call get_number_input with "Enter Profit: " storing result in profit
            call get_number_input with "Enter Cost: " storing result in cost
            set price to cost + profit
            set margin to (profit / price) * 100
            set markup to (profit / cost) * 100

        otherwise if mode equals "markup_cost"
            call get_number_input with "Enter Markup: " storing result in markup
            call get_number_input with "Enter Cost: " storing result in cost
            set profit to cost * (markup / 100)
            set price to cost + profit
            set margin to (profit / price) * 100
        
        set results to ["_":""]
        set results["price"] to price
        set results["margin"] to margin
        set results["profit"] to profit
        set results["markup"] to markup
        set results["cost"] to cost

        return results
